
\RequirePackage[l2tabu, orthodox]{nag}

\documentclass[a4paper,12pt]{article}
\synctex=1

\usepackage{geometry}%, showframe
\usepackage{microtype}
%\usepackage[utf8]{inputenc}
%\usepackage[T1]{fontenc}

\usepackage{listings}

\usepackage{hyperref}
\usepackage{rerunfilecheck}

\usepackage[toc, record]{glossaries-extra}% after hypertex

\GlsXtrLoadResources[
  %dual-entry-backlink={false},
  src={../glossary},
  sort={en-GB}
]

\bibliographystyle{abstract}%{alpha}%{aaai-named}%
%\bibliographystyle{alpha}


\begin{document}

\title{On writing \LaTeX{} documents for the simuline organization}
\author{Dr.~Ernst Rei√üner}
%\date{\today}% date is not allowed 
\maketitle


\newpage

\tableofcontents % to create file .toc
\listoffigures
\listoftables
%\newpage

\section{Introduction}

This document contains rules how to write documents specifically in \LaTeX. 
Of course all rules for writing documents apply (TBD\@: reference) 
and this documents focuses on aspects specific for latex documents. 
The rules here are followed for simuline organization, 
but is applicable in a broader context maybe with modifications. 

At the current stage, this document is only a torso. 
Its purpose is to check whether the overall bibliography is usable. 


\section{Tools}\label{sec:tools}

\LaTeX{} is a compiled language. 
Thus, one needs an editor, possibly with an according \LaTeX-extension, 
the proper compiler and a viewer for each output format. 

As an editor \texttt{emacs} with extension \texttt{auctex} 
is a possible choice, but we chose visual \texttt{code} with an according extension. 
TBD\@: add a reference to the install script for \texttt{code}. 
The main viewer is \texttt{okular} but also \texttt{chrome} with markdown extension (TBD\@: which) 
is needed. 
What makes latex difficult from a point of view of tooling is, 
that there is not a single converter but a universe of related tools, 
e.g.\@ to make a bibliography or an index, 
and also latex itself must be enriched loading appropriate packages. 

TBD\@: add reference to the installation script \texttt{zypper} 
and installation script for visual code extensions, among them also those for latex. 
TBD\@: think about how to reference documents in Markdown format. 


As \texttt{maven} is the general build tool, we bundle all those converters 
in a single maven plugin which does nothing but invoking converters by need. 
For our special needs, we developed the 
\href{https://github.com/Reissner/latex-maven-plugin}{\texttt{latex-maven-plugin}}. 
Starting from version 1.5, it has a goal \texttt{vrs} listing all converters 
with their applicable versions. 
It is recommended to have all of them installed. 
In addition, there are lots of latex-packages required, 
all of them in the \texttt{texlife} distribution 
which contains also most of the converters, but not all of them. 
The site of the plugin gives hints on the pieces of software used by the plugin 
and provides a manual covering the full functionality. 

What is important from the point of view of quality management is, 
that the plugin detects failures and warnings so 
that if conversely the build process completes without error or warning, 
one can be sure that the result is without failure also. 
Another point is that the plugin is for building all documents in one build run 
but supports also development of a single document. 
Maybe the most widely used tool for building a single \LaTeX{} document 
is \texttt{latexmk} and the plugin is designed to cooperate with \texttt{latexmk}, 
switching to \texttt{latexmk} if an error occurs or if a section must be added 
and then again switching back to the plugin if all documents shall be complied. 
Starting with version 2.0, 
the \href{https://github.com/Reissner/latex-maven-plugin}{\texttt{latex-maven-plugin}} 
has also a goal \texttt{dvl} which creates a file \texttt{.latexmkrc} 
which defines a configuration for \texttt{latexmk} 
and which is in line with the options used for the latex plugin. 



In the long run, 
all projects, even this one shall use the \texttt{latex-maven-plugin}. 
This is currently not possible because this would introduce a cyclic dependency, 
because on the one hand, the latex plugin is subject to the rules 
prescribed in this quality management project 
and must be referenced in the latex plugin project, 
and on the other hand, 
this quality management project needs the plugin to build. 
This can only be resolved if this one project 
refers to a lower version of the sibling project. 
At the beginning, this is not possible. 
In general, compilation should work with default parameters. 

For now, this document is generated locally 
only using command line tools \texttt{lualatex} and \texttt{bibtex} 
(in future we will require \texttt{biber} which presupposes the package \texttt{biblatex}). 
Later we require a glossary and an index, glossary with \texttt{bib2gls} 
and an index, where the tooling is not yet so clear. 
Instead of directly using the combination of these tools, 
one could use \texttt{latexmk} 
with an appropriate config file \texttt{.latexmkrc} created by the plugin. 

\subsection{Configuration}\label{subsec:toolConf}

This section collects configuration of \TeX{} documents. 
A big part of configuration is the set of packages used 
and the options of the packages. 
Note that these packages partially presuppose the abovementioned tools. 
These tools are mandatory also in other cases for sake of reproducibility. 

Some packages must be loaded before declaration of the \texttt{documentclass}. 
This document is just an example. 

\lstinputlisting[firstline=2, lastline=2]{test}%\RequirePackage

Then comes the declaration of the \texttt{documentclass}. 
Currently, we support the classes \texttt{article}, \texttt{book} and \texttt{beamer}. 
Since this is a (western) European company, only a4 paper is supported. 
This shall be provided by the package \texttt{geometry}, 
but the option shall be given not as package option but as \texttt{documentclass} option 
to make it available to other packages also. 
Font size of 12pt shall be in general used. 

\lstinputlisting[firstline=4, lastline=4]{test}%\documentclass

It is a requirement to support ``document development''. 
This includes making a development environment as much 
WYSIWIG\footnote{What you see is what you get}-like as possible. 
To that end, one shall activate synctex as follows 

\lstinputlisting[firstline=5, lastline=5]{test}%\documentclass


After that, in the long run further packages shall be input from a general header file. 
In the time to be, we specify here the packages needed and prohibited: 
%
\begin{description}
  \item[prohibited] 
  \texttt{inputenc}, 
  \texttt{fontenc} because these do not fit \texttt{lualatex}. 
  \item[mandatory] 
  \texttt{geometry}, \texttt{microtype}, \texttt{rerunfilecheck}, 
  \texttt{listings}, \texttt{hyperref}. 
  The package \texttt{hyperref} must be used, among others, with option \texttt{destlabel} 
  as explained in Section~\ref{sec:secs}. 
  This listing is incomplete. 
  \item[future] in future \texttt{biblatex} is mandatory. 
\end{description}

\section{Sections and other structures}\label{sec:secs}

Each document needs a title and an author 
and an identification of the version of the document. 
What is not allowed is a date, because this corrupts certain equality checks: 
A generated PDF file shall change only 
if this is really intended and not because the date changes 
(which happens every day).  
If a document refers to software, as e.g\@. a manual, 
the version of the document is that of the software. 

Each document requires a table of contents. 
If there are figures, tables or listings, then also an according table, 
e.g.\@ table of figures, is required. 

All documents shall have a reference, an index and a glossary. 
Each of them must have an entry in the table of contents. 

An introductory section is mandatory and in most cases, 
it is advisable to have a summary or a miscellaneous section, 
or a section with open points. 

Each section, no matter which level, i.e. applies also to chapters in books, 
is numbered and has a label for reference. 
If it has subsections, it has some introducing text mentioning all immediate subsections 
and reference them. 

Also figures, tables and listings are labeled and must be referenced at least once. 

Note that it is mandatory to use the package \texttt{hyperref} 
with at least the option \texttt{destlabel}. 
This allows to access sections and floating structures 
of PDF document on the internet. 
For example, the manual of the latex plugin 
is located at \url{http://www.simuline.eu/LatexMavenPlugin/manualLMP.pdf}. 
Its chapter on installation has label \texttt{chap:install}, 
so this chapter is accessible 
via \url{http://www.simuline.eu/LatexMavenPlugin/manualLMP.pdf#chap:install}. 


\section{Miscellaneous}\label{sec:misc}

A big subject is how to obtain reproducible documents. 
Also documents which contain computed data, either figure or computed pictures. 
A discussion on \texttt{pythontex} can be found in~\cite{Poo15}. 
We are lucky that \texttt{pythontex} allows computations in python but also in octave, 
i.e.\@ in the matlab language,  
the two major languages we use besides our developing language java. 

Note that there are alternatives to 


\subsection{How to deal with ltex}\label{subsec:ltex}

Ltex has many rules but there is one particular, which is difficult to conform with. 
It is about spacing. 

The root of the problem is, that \LaTeX{} inserts more space after full stop, 
but not after other dot followed by a space. 
But how does \LaTeX{} decide this? If the dot is preceeded by a lower case letter, 
then it assumes a full stop, after an upper case letter it assumes no full stop. 
This rule applies in most cases but not in all. 
Here are two examples: 
%
\begin{itemize}
  \item ``Apple Inc. sells phones''% chktex 12
  Here, \LaTeX{} thinks the period ends a sentence and wrongly adds an extra space.
  \item ``My school scores were all A. Einstein would be proud of me!'
  Here, \LaTeX{} does not realize that the period ends a sentence and does not add the expected space. 
  Note that chtex does not find this problem. 
\end{itemize}

The problem is solved by adding an invisible lower case letter by \texttt{\textbackslash@}. 
Note how spacing improves: 
\begin{itemize}
  \item ``Apple Inc.\@ sells phones''
  \item ``My school scores were all A\@. Einstein would be proud of me!'
\end{itemize}

\subsection{Terminology Management, Glossaries}\label{subsec:glos}

Terminology management means that basic terms are defined at a single source. 
It is decided that this places is a file in BIB format read by \texttt{bib2bls}. 
It is conceivable to have more than one of these BIB files 
but each term must be defined once over all BIB files. 

A very good example of how useful and necessary terminology management is, 
are the terms \gls{precN} and \gls{accN} referring to numbers 
versus \gls{precM} and \gls{accM} referring to measurement. 

\subsection{Relation to other documentation systems}

Here are important: 
`markdown`': how to include markdown in a tex file. 
jypyter notebooks: `jypynotex`'
`texinfo`'. 



\printunsrtglossaries%
\bibliography{litPublic}

\end{document}